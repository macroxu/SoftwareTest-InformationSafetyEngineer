- [linux 防火墙](#linux-防火墙)
  - [1. 查看防火墙tables](#1-查看防火墙tables)
  - [2. 清空防火墙tables](#2-清空防火墙tables)
  - [3. 设置防火墙默认规则](#3-设置防火墙默认规则)
  - [4. 设置允许回环接口(本机访问本机)](#4-设置允许回环接口本机访问本机)
  - [5. 设置允许已建立的或相关连的通行](#5-设置允许已建立的或相关连的通行)
  - [6. 设置允许某个IP访问本机的22端口](#6-设置允许某个ip访问本机的22端口)
  - [7. 设置允许本机访问外部的22端口](#7-设置允许本机访问外部的22端口)
  - [8. 设置允许本机访问外部的80端口](#8-设置允许本机访问外部的80端口)
  - [9. 设置允许本机访问外部的443端口](#9-设置允许本机访问外部的443端口)


# linux 防火墙
## 1. 查看防火墙tables
```shell
iptables -L -n
```
## 2. 清空防火墙tables
```shell
iptables -F
```
## 3. 设置防火墙默认规则
```shell
iptables -P INPUT DROP
iptables -P OUTPUT DROP
iptables -P FORWARD DROP
```
## 4. 设置允许回环接口(本机访问本机)
```shell
iptables -A INPUT -i lo -j ACCEPT
iptables -A OUTPUT -o lo -j ACCEPT
```
## 5. 设置允许已建立的或相关连的通行
```shell
iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT    
iptables -A OUTPUT -m state --state ESTABLISHED,RELATED -j ACCEPT
```
## 6. 设置允许某个IP访问本机的22端口
```shell
iptables -A INPUT -p tcp -s
```
## 7. 设置允许本机访问外部的22端口
```shell
iptables -A OUTPUT -p tcp --dport 22 -j ACCEPT
```
## 8. 设置允许本机访问外部的80端口
```shell
iptables -A OUTPUT -p tcp --dport 80 -j ACCEPT
```
## 9. 设置允许本机访问外部的443端口
```shell
iptables -A OUTPUT -p tcp --dport 443 -j ACCEPT
 

 [root@ywgl3 ~]# iptables -L
Chain INPUT (policy ACCEPT)
target     prot opt source               destination         
ACCEPT     all  --  anywhere             anywhere             state RELATED,ESTABLISHED
ACCEPT     icmp --  anywhere             anywhere            
ACCEPT     all  --  anywhere             anywhere            
DROP       tcp  --  10.196.22.1          anywhere             tcp dpt:ssh
ACCEPT     tcp  --  10.196.20.128/25     anywhere             state NEW tcp dpt:ssh
ACCEPT     tcp  --  10.196.22.0/25       anywhere             state NEW tcp dpt:ssh
DROP       tcp  --  anywhere             anywhere             tcp dpt:ssh
ACCEPT     tcp  --  anywhere             anywhere             state NEW tcp dpt:ssh
ACCEPT     all  --  10.196.24.0/24       anywhere            
ACCEPT     all  --  10.196.23.0/24       anywhere            
ACCEPT     all  --  10.196.22.0/24       anywhere            
ACCEPT     all  --  10.196.21.0/24       anywhere            
ACCEPT     all  --  10.196.20.0/24       anywhere            
ACCEPT     all  --  192.168.0.0/16       anywhere            
ACCEPT     all  --  172.16.0.0/12        anywhere            
REJECT     all  --  anywhere             anywhere             reject-with icmp-host-prohibited

Chain FORWARD (policy ACCEPT)
target     prot opt source               destination         
DOCKER-USER  all  --  anywhere             anywhere            
DOCKER-ISOLATION-STAGE-1  all  --  anywhere             anywhere            
ACCEPT     all  --  anywhere             anywhere             ctstate RELATED,ESTABLISHED
DOCKER     all  --  anywhere             anywhere            
ACCEPT     all  --  anywhere             anywhere            
ACCEPT     all  --  anywhere             anywhere            
ACCEPT     all  --  anywhere             anywhere             ctstate RELATED,ESTABLISHED
DOCKER     all  --  anywhere             anywhere            
ACCEPT     all  --  anywhere             anywhere            
ACCEPT     all  --  anywhere             anywhere            
ACCEPT     all  --  anywhere             anywhere             ctstate RELATED,ESTABLISHED
DOCKER     all  --  anywhere             anywhere            
ACCEPT     all  --  anywhere             anywhere            
ACCEPT     all  --  anywhere             anywhere            
ACCEPT     all  --  anywhere             anywhere             ctstate RELATED,ESTABLISHED
DOCKER     all  --  anywhere             anywhere            
ACCEPT     all  --  anywhere             anywhere            
ACCEPT     all  --  anywhere             anywhere            
ACCEPT     all  --  anywhere             anywhere             ctstate RELATED,ESTABLISHED
DOCKER     all  --  anywhere             anywhere            
ACCEPT     all  --  anywhere             anywhere            
ACCEPT     all  --  anywhere             anywhere            
ACCEPT     all  --  anywhere             anywhere            

Chain OUTPUT (policy ACCEPT)
target     prot opt source               destination         
ACCEPT     all  --  anywhere             anywhere            

Chain DOCKER (5 references)
target     prot opt source               destination         
ACCEPT     tcp  --  anywhere             172.18.0.2           tcp dpt:mysql
ACCEPT     tcp  --  anywhere             172.20.0.2           tcp dpt:webcache
ACCEPT     tcp  --  anywhere             172.20.0.3           tcp dpt:webcache

Chain DOCKER-ISOLATION-STAGE-1 (1 references)
target     prot opt source               destination         
DOCKER-ISOLATION-STAGE-2  all  --  anywhere             anywhere            
DOCKER-ISOLATION-STAGE-2  all  --  anywhere             anywhere            
DOCKER-ISOLATION-STAGE-2  all  --  anywhere             anywhere            
DOCKER-ISOLATION-STAGE-2  all  --  anywhere             anywhere            
DOCKER-ISOLATION-STAGE-2  all  --  anywhere             anywhere            
RETURN     all  --  anywhere             anywhere            

Chain DOCKER-ISOLATION-STAGE-2 (5 references)
target     prot opt source               destination         
DROP       all  --  anywhere             anywhere            
DROP       all  --  anywhere             anywhere            
DROP       all  --  anywhere             anywhere            
DROP       all  --  anywhere             anywhere            
DROP       all  --  anywhere             anywhere            
RETURN     all  --  anywhere             anywhere            

Chain DOCKER-USER (1 references)
target     prot opt source               destination         
RETURN     all  --  anywhere             anywhere        